# Docker Compose Secrets Configuration
# Bu dosyayý docker-compose.yml ile birleþtirin

version: '3.8'


secrets:
  openai_api_key:
    file: ./secrets/openai_api_key
  anthropic_api_key:
    file: ./secrets/anthropic_api_key
  aws_access_key_id:
    file: ./secrets/aws_access_key_id
  aws_secret_access_key:
    file: ./secrets/aws_secret_access_key
  assemblyai_api_key:
    file: ./secrets/assemblyai_api_key
  postgres_password:
    file: ./secrets/postgres_password


services:
  backend:

    secrets:
      - openai_api_key
      - anthropic_api_key
      - aws_access_key_id
      - aws_secret_access_key
      - assemblyai_api_key
      - postgres_password

    environment:
      # Secrets dosya yollarýný environment variable olarak ekle
      OPENAI_API_KEY_FILE: /run/secrets/openai_api_key
      ANTHROPIC_API_KEY_FILE: /run/secrets/anthropic_api_key
      AWS_ACCESS_KEY_ID_FILE: /run/secrets/aws_access_key_id
      AWS_SECRET_ACCESS_KEY_FILE: /run/secrets/aws_secret_access_key
      ASSEMBLYAI_API_KEY_FILE: /run/secrets/assemblyai_api_key
      POSTGRES_PASSWORD_FILE: /run/secrets/postgres_password

  scraper:

    secrets:
      - openai_api_key
      - anthropic_api_key
      - aws_access_key_id
      - aws_secret_access_key
      - assemblyai_api_key
      - postgres_password

    environment:
      OPENAI_API_KEY_FILE: /run/secrets/openai_api_key
      ANTHROPIC_API_KEY_FILE: /run/secrets/anthropic_api_key
      POSTGRES_PASSWORD_FILE: /run/secrets/postgres_password

  postgres:
    secrets:
      - postgres_password
    environment:
      POSTGRES_PASSWORD_FILE: /run/secrets/postgres_password
